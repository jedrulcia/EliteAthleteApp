@using EliteAthleteApp.Constants
@using EliteAthleteApp.Models.User

@model UserVM


@{
	ViewData["Title"] = "Panel";
	var errorMessage = TempData["ErrorMessage"] as string;
}

@if (!string.IsNullOrEmpty(errorMessage))
{
	<div class="alert alert-danger">
		@errorMessage
	</div>
}
<body>
	<div class="container">
		<h3 class="text-gradient-primary">@Model.FirstName @Model.LastName Panel</h3>
		<div class="row justify-content-center">
			<div class="col-md-12">
				<ul class="nav nav-tabs" id="actionPanelTabs" role="tablist">
					<li class="nav-item" role="presentation">
						<button class="nav-link createBtn" type="button" data-userid="@Model.Id" data-coachid="@Model.CoachId" aria-selected="false">
							<i class="bi bi-plus-square-fill">&nbsp;</i><strong>Create New Training Module</strong>
						</button>
					</li>
					<li class="nav-item" role="presentation">
						<button data-userid="@Model.Id"
								class="nav-link createOrmBtn" type="button" aria-selected="false">
							<i class="bi bi-plus-square-fill">&nbsp;</i>
							<strong>Add New ORM</strong>
						</button>
					</li>
					<li class="nav-item" role="presentation">
						<button data-userid="@Model.Id"
								class="nav-link createUbmBtn" type="button" aria-selected="false">
							<i class="bi bi-plus-square-fill">&nbsp;</i>
							<strong>Add New UBM</strong>
						</button>
					</li>
				</ul>
				<br />
			</div>
			<div class="col-md-12">
				<ul class="nav nav-tabs" id="userPanelTabs" role="tablist">
					<li class="nav-item" role="presentation">
						<a class="nav-link active" id="trainingModuleTab" data-toggle="tab" data-userid="@Model.Id" href="#trainingModule" role="tab" aria-controls="trainingModule" aria-selected="true">
							<i class="bi bi-person">&nbsp;</i>
							<strong>Training Modules</strong>
						</a>
					</li>
					<li class="nav-item" role="presentation">
						<a class="nav-link" id="userInfoTab" data-toggle="tab" data-userid="@Model.Id" href="#userInfo" role="tab" aria-controls="userInfo" aria-selected="true">
							<i class="bi bi-person">&nbsp;</i>
							<strong>Info</strong>
						</a>
					</li>
					<li class="nav-item" role="presentation">
						<a class="nav-link" id="ormTab" data-toggle="tab" data-userid="@Model.Id" href="#orm" role="tab" aria-controls="orm" aria-selected="true">
							<i class="bi bi-person">&nbsp;</i>
							<strong>ORMs</strong>
						</a>
					</li>
					<li class="nav-item" role="presentation">
						<a class="nav-link" id="ubmTab" data-toggle="tab" data-userid="@Model.Id" href="#ubm" role="tab" aria-controls="ubm" aria-selected="true">
							<i class="bi bi-person">&nbsp;</i>
							<strong>UBMs</strong>
						</a>
					</li>
				</ul>
				<br />
				<div class="tab-content" id="userPanelTabsContent">
					<div class="tab-pane fade show active" id="trainingModule" role="tabpanel" aria-labelledby="trainingModuleTab">
						<h1><span class="badge bg-black d-block w-100"><strong>Training Modules</strong></span></h1>
					</div>
					<div class="tab-pane fade" id="userInfo" role="tabpanel" aria-labelledby="userInfoTab">
						<h1><span class="badge bg-black d-block w-100"><strong>Info</strong></span></h1>
					</div>
					<div class="tab-pane fade" id="orm" role="tabpanel" aria-labelledby="ormTab">
						<h1><span class="badge bg-black d-block w-100"><strong>My ORMs (One-Rep Max)</strong></span></h1>
					</div>
					<div class="tab-pane fade" id="ubm" role="tabpanel" aria-labelledby="ubmTab">
						<h1><span class="badge bg-black d-block w-100"><strong>My UBMs</strong></span></h1>
					</div>
				</div>
			</div>
		</div>
	</div>
</body>

<!-- MODAL FOR TRAINING MODULE CREATE -->
<div class="modal fade" id="trainingModuleCreateModal" tabindex="-1" role="dialog" aria-labelledby="trainingModuleCreateModalLabel" aria-hidden="true">
	<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<h3 class="modal-title w-100" id="trainingModuleCreateModalLabel">
					<span class="badge bg-dark d-flex justify-content-between align-items-center w-100">
						<strong>Create New Training Module</strong>
						<button type="button" class="close btn text-white" data-dismiss="modal" aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
					</span>
				</h3>
			</div>
			<div class="modal-body" id="trainingModuleCreateContent">
			</div>
		</div>
	</div>
</div>

<!-- MODAL FOR TRAINING MODULE EDIT -->
<div class="modal fade" id="trainingModuleEditModal" tabindex="-1" role="dialog" aria-labelledby="trainingModuleEditModalLabel" aria-hidden="true">
	<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<h3 class="modal-title w-100" id="trainingModuleEditModalLabel">
					<span class="badge bg-dark d-flex justify-content-between align-items-center w-100">
						<strong>Edit Training Module</strong>
						<button type="button" class="close btn text-white" data-dismiss="modal" aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
					</span>
				</h3>
			</div>
			<div class="modal-body" id="trainingModuleEditContent">
			</div>
		</div>
	</div>
</div>

<!-- MODAL FOR TRAINING MODULE DELETE -->
<div class="modal fade" id="trainingModuleDeleteModal" tabindex="-1" role="dialog" aria-labelledby="trainingModuleDeleteModalLabel" aria-hidden="true">
	<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<h3 class="modal-title w-100" id="trainingModuleDeleteModalLabel">
					<span class="badge bg-dark d-flex justify-content-between align-items-center w-100">
						<strong>Delete Training Module</strong>
						<button type="button" class="close btn text-white" data-dismiss="modal" aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
					</span>
				</h3>
			</div>
			<div class="modal-body" id="trainingModuleDeleteContent">
			</div>
		</div>
	</div>
</div>

<!-- MODAL FOR ORM CREATE -->
<div class="modal fade" id="ormCreateModal" tabindex="-1" role="dialog" aria-labelledby="ormCreateModalLabel" aria-hidden="true">
	<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<h3 class="modal-title w-100" id="ormCreateModalLabel">
					<span class="badge bg-dark d-flex justify-content-between align-items-center w-100">
						<strong>Create New ORM (One-Rep Max)</strong>
						<button type="button" class="close btn text-white" data-dismiss="modal" aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
					</span>
				</h3>
			</div>
			<div class="modal-body" id="ormCreateContent">
			</div>
		</div>
	</div>
</div>

<!-- MODAL FOR ORM EDIT -->
<div class="modal fade" id="ormEditModal" tabindex="-1" role="dialog" aria-labelledby="ormEditModalLabel" aria-hidden="true">
	<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<h3 class="modal-title w-100" id="ormEditModalLabel">
					<span class="badge bg-dark d-flex justify-content-between align-items-center w-100">
						<strong>Edit ORM (One-Rep Max)</strong>
						<button type="button" class="close btn text-white" data-dismiss="modal" aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
					</span>
				</h3>
			</div>
			<div class="modal-body" id="ormEditContent">
			</div>
		</div>
	</div>
</div>

<!-- MODAL FOR ORM DELETE -->
<div class="modal fade" id="ormDeleteModal" tabindex="-1" role="dialog" aria-labelledby="ormDeleteModalLabel" aria-hidden="true">
	<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<h3 class="modal-title w-100" id="ormDeleteModalLabel">
					<span class="badge bg-dark d-flex justify-content-between align-items-center w-100">
						<strong>Delete ORM (One-Rep Max)</strong>
						<button type="button" class="close btn text-white" data-dismiss="modal" aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
					</span>
				</h3>
			</div>
			<div class="modal-body" id="ormDeleteContent">
			</div>
		</div>
	</div>
</div>

<!-- MODAL FOR UBM CREATE -->
<div class="modal fade" id="ubmCreateModal" tabindex="-1" role="dialog" aria-labelledby="ubmCreateModalLabel" aria-hidden="true">
	<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<h3 class="modal-title w-100" id="ubmCreateModalLabel">
					<span class="badge bg-dark d-flex justify-content-between align-items-center w-100">
						<strong>Create New User Body Measurements</strong>
						<button type="button" class="close btn text-white" data-dismiss="modal" aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
					</span>
				</h3>
			</div>
			<div class="modal-body" id="ubmCreateContent">
			</div>
		</div>
	</div>
</div>

<!-- MODAL FOR UBM EDIT -->
<div class="modal fade" id="ubmEditModal" tabindex="-1" role="dialog" aria-labelledby="ubmEditModalLabel" aria-hidden="true">
	<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<h3 class="modal-title w-100" id="ubmEditModalLabel">
					<span class="badge bg-dark d-flex justify-content-between align-items-center w-100">
						<strong>Edit User Body Measurements</strong>
						<button type="button" class="close btn text-white" data-dismiss="modal" aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
					</span>
				</h3>
			</div>
			<div class="modal-body" id="ubmEditContent">
			</div>
		</div>
	</div>
</div>

<!-- MODAL FOR UBM DELETE -->
<div class="modal fade" id="ubmDeleteModal" tabindex="-1" role="dialog" aria-labelledby="ubmDeleteModalLabel" aria-hidden="true">
	<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<h3 class="modal-title w-100" id="ubmDeleteModalLabel">
					<span class="badge bg-dark d-flex justify-content-between align-items-center w-100">
						<strong>Delete User Body Measurements</strong>
						<button type="button" class="close btn text-white" data-dismiss="modal" aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
					</span>
				</h3>
			</div>
			<div class="modal-body" id="ubmDeleteContent">
			</div>
		</div>
	</div>
</div>

@section Scripts
{
	<script>
		$(function () {

			// DATATABLE INITIALIZE
			$('.table').DataTable();

			// SCRIPT TO HANDLE CLOSING MODALS
			$(document).on('click', '.close', function () {
				$(this).closest('.modal').modal('hide');
			});

			// HANDLE SWITCHING TABS
			$('#userPanelTabs a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
				e.target // newly activated tab
				e.relatedTarget // previous tab
			});


			$('a[data-toggle="tab"]').on("shown.bs.tab", function (e) {
				$($.fn.dataTable.tables(true)).DataTable().fixedHeader.adjust();
			});

			// SCRIPT TO HANDLE LOADING TRAINING MODULE TAB AFTER OPENING INDEX
			var userId = $('#trainingModuleTab').data("userid");
			$.ajax({
				url: '@Url.Action("List", "TrainingModules")',
				type: 'GET',
				data: { userId: userId },
				success: function (data) {
					$('#trainingModule').html(data);
					$('.table').DataTable();
					$('#trainingModuleTab').tab('show');

				},
				error: function () {
					alert("An error occurred while loading 'trainingModule' content.");
				}
			});

			// SCRIPT FOR HANDLING TRAINING MODULE TAB
			$('#trainingModuleTab').on('click', function (e) {
				e.preventDefault();

				var userId = $(this).data("userid");

				$.ajax({
					url: '@Url.Action("List", "TrainingModules")',
					type: 'GET',
					data: { userId: userId },
					success: function (data) {
						$('#trainingModule').html(data);
						$('.table').DataTable();
						$('#trainingModuleTab').tab('show');

					},
					error: function () {
						alert("An error occurred while loading 'trainingModule' content.");
					}
				});
			});

			// SCRIPT FOR HANDLING ORM TAB
			$('#ormTab').on('click', function (e) {
				e.preventDefault();

				var userId = $(this).data("userid");

				$.ajax({
					url: '@Url.Action("List", "TrainingOrms")',
					type: 'GET',
					data: { userId: userId },
					success: function (data) {
						$('#orm').html(data);
						$('.table').DataTable();
						$('#ormTab').tab('show');

					},
					error: function () {
						alert("An error occurred while loading 'orm' content.");
					}
				});
			});

			// SCRIPT FOR HANDLING UBM TAB
			$('#ubmTab').on('click', function (e) {
				e.preventDefault();

				var userId = $(this).data("userid");

				$.ajax({
					url: '@Url.Action("List", "UserBodyMeasurements")',
					type: 'GET',
					data: { userId: userId },
					success: function (data) {
						$('#ubm').html(data);
						$('.table').DataTable();
						$('#ubmTab').tab('show');

					},
					error: function () {
						alert("An error occurred while loading 'ubm' content.");
					}
				});
			});

			// SCRIPT FOR HANDLING USER INFO TAB
			$('#userInfoTab').on('click', function (e) {
				e.preventDefault();

				var userId = $(this).data("userid");

				$.ajax({
					url: '@Url.Action("Info", "Users")',
					type: 'GET',
					data: { userId: userId },
					success: function (data) {
						$('#userInfo').html(data);
						$('#userInfoTab').tab('show');
					},
					error: function () {
						alert("An error occurred while loading user info content.");
					}
				});
			});

			// AJAX FOR LOADING TRAINING MODULE CREATE MODAL
			$(document).on('click', '.createBtn', function (e) {
				e.preventDefault();

				var userId = $(this).data("userid");
				var coachId = $(this).data("coachid");
				$.ajax({
					url: '@Url.Action("Create", "TrainingModules")',
					type: 'GET',
					data: { userId: userId, coachId: coachId },
					success: function (data) {
						$('#trainingModuleCreateContent').html(data);
						$('#trainingModuleCreateModal').modal('show');
					},
					error: function () {
						alert("An error occurred while loading the trainingModuleCreate modal.");
					}
				});
			});

			// AJAX FOR LOADING TRAINING MODULE EDIT MODAL
			$(document).on('click', '.editBtn', function (e) {
				e.preventDefault();

				var trainingModuleId = $(this).data("trainingmoduleid");
				$.ajax({
					url: '@Url.Action("Edit", "TrainingModules")',
					type: 'GET',
					data: { trainingModuleId: trainingModuleId },
					success: function (data) {
						$('#trainingModuleEditContent').html(data);
						$('#trainingModuleEditModal').modal('show');
					},
					error: function () {
						alert("An error occurred while loading the trainingModuleCreate modal.");
					}
				});
			});

			// AJAX FOR LOADING TRAINING MODULE DELETE MODAL
			$(document).on('click', '.deleteBtn', function (e) {
				e.preventDefault();

				var trainingModuleId = $(this).data("trainingmoduleid");
				$.ajax({
					url: '@Url.Action("Delete", "TrainingModules")',
					type: 'GET',
					data: { trainingModuleId: trainingModuleId },
					success: function (data) {
						$('#trainingModuleDeleteContent').html(data);
						$('#trainingModuleDeleteModal').modal('show');
					},
					error: function () {
						alert("An error occurred while loading the trainingModuleDelete modal.");
					}
				});
			});

			// AJAX FOR LOADING TRAINING ORM CREATE MODAL
			$(document).on('click', '.createOrmBtn', function (e) {
				e.preventDefault();

				var userId = $(this).data("userid");
				$.ajax({
					url: '@Url.Action("Create", "TrainingOrms")',
					type: 'GET',
					data: { userId: userId },
					success: function (data) {
						$('#ormCreateContent').html(data);
						$('#ormCreateModal').modal('show');
					},
					error: function () {
						alert("An error occurred while loading the orm create modal.");
					}
				});
			});

			// AJAX FOR LOADING TRAINING ORM EDIT MODAL
			$(document).on('click', '.editOrmBtn', function (e) {
				e.preventDefault();

				var trainingOrmId = $(this).data("trainingormid");
				$.ajax({
					url: '@Url.Action("Edit", "TrainingOrms")',
					type: 'GET',
					data: { trainingOrmId: trainingOrmId },
					success: function (data) {
						$('#ormEditContent').html(data);
						$('#ormEditModal').modal('show');
					},
					error: function () {
						alert("An error occurred while loading the orm edit modal.");
					}
				});
			});

			// AJAX FOR LOADING TRAINING ORM Delete MODAL
			$(document).on('click', '.deleteOrmBtn', function (e) {
				e.preventDefault();

				var trainingOrmId = $(this).data("trainingormid");
				$.ajax({
					url: '@Url.Action("Delete", "TrainingOrms")',
					type: 'GET',
					data: { trainingOrmId: trainingOrmId },
					success: function (data) {
						$('#ormDeleteContent').html(data);
						$('#ormDeleteModal').modal('show');
					},
					error: function () {
						alert("An error occurred while loading the orm delete modal.");
					}
				});
			});

			// AJAX FOR LOADING TRAINING UBM CREATE MODAL
			$(document).on('click', '.createUbmBtn', function (e) {
				e.preventDefault();

				var userId = $(this).data("userid");
				$.ajax({
					url: '@Url.Action("Create", "UserBodyMeasurements")',
					type: 'GET',
					data: { userId: userId },
					success: function (data) {
						$('#ubmCreateContent').html(data);
						$('#ubmCreateModal').modal('show');
					},
					error: function () {
						alert("An error occurred while loading the ubm create modal.");
					}
				});
			});

			// AJAX FOR LOADING TRAINING UBM EDIT MODAL
			$(document).on('click', '.editUbmBtn', function (e) {
				e.preventDefault();

				var bodyMeasurementId = $(this).data("editubmid");
				$.ajax({
					url: '@Url.Action("Edit", "UserBodyMeasurements")',
					type: 'GET',
					data: { bodyMeasurementId: bodyMeasurementId },
					success: function (data) {
						$('#ubmEditContent').html(data);
						$('#ubmEditModal').modal('show');
					},
					error: function () {
						alert("An error occurred while loading the ubm edit modal.");
					}
				});
			});

			// AJAX FOR LOADING TRAINING UBM Delete MODAL
			$(document).on('click', '.deleteUbmBtn', function (e) {
				e.preventDefault();

				var bodyMeasurementId = $(this).data("deleteubmid");
				$.ajax({
					url: '@Url.Action("Delete", "UserBodyMeasurements")',
					type: 'GET',
					data: { bodyMeasurementId: bodyMeasurementId },
					success: function (data) {
						$('#ubmDeleteContent').html(data);
						$('#ubmDeleteModal').modal('show');
					},
					error: function () {
						alert("An error occurred while loading the ubm delete modal.");
					}
				});
			});
		});
	</script>
}